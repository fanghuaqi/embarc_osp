<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>embARC: Board</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 50px;">
  <td id="projectlogo"><img alt="Logo" src="embARC_Logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectnumber">2017.12</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_board.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Board </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sect_board_introduction">Introduction</a></li>
<li class="level1"><a href="#sect_board_common_board_init_process">Common Board Initialization Process</a></li>
<li class="level1"><a href="#sect_board_resource_unified_definitions">Board Resource Unified Definition</a></li>
<li class="level1"><a href="#sect_board_supported_boards_in_embARC">Supported Boards in embARC</a></li>
<li class="level1"><a href="#sect_board_add_new_board_to_embARC">Adding New Board to embARC</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="sect_board_introduction"></a>
Introduction</h1>
<p>The <b>Board Support Package (BSP) Layer</b> provides support for different boards based on ARCv2 processors. The layer contains the following functions: <br/>
</p>
<ul>
<li><b>Peripherals driver instantiation</b> <br/>
 In embARC, an object-oriented design is applied for device drivers. The peripheral driver implementations are similar to the definition of class in the device abstraction layer. So the peripheral drivers should be instantiated for every board. For example, dw_gpio_obj.c / dw_gpio_obj.h is the instantiation of the DesignWare GPIO driver implementation in device abstraction layer, which contains the information of register address, interrupt number, etc.</li>
<li><b>Common board initialization process</b> <br/>
 A standard bootup process is defined for each board. The entry of this process is <b>board_main</b> defined in <b><a class="el" href="board_8c_source.html">board/board.c</a></b>, it will cover board initialization, os environment setup, fatfs and ntshell initialization, finally it will enter to <em>main</em> function if required.</li>
<li><b>Board resource unified definition</b> <br/>
 Most boards share common peripherals. Unified definitions are provided such as UART used to print messages, SD card interface, buttons, LEDs.</li>
<li><b>Linker script for boards</b> <br/>
 Linker script now is auto-generated from template using the ICCM/DCCM and DDR memory information. We provided template for both gnu and metaware tool, located in <b>board</b> folder, called <em>linker_template_gnu.ld</em> and <em>linker_template_mw.ld</em>.</li>
</ul>
<h1><a class="anchor" id="sect_board_common_board_init_process"></a>
Common Board Initialization Process</h1>
<p>The common <em>board_main</em> function should do the following operations:</p>
<ul>
<li>Board initialization steps - defined in <em>board_init</em> function.<ul>
<li>Install required device driver objects, such as UART/SPI/IIC device objects.</li>
<li>Clear and disable all interrupts.</li>
<li>Initialize 1 ms timer interrupt.</li>
<li>Initialize some peripherals if used.</li>
<li>Initialize other required board resources such as mux controller.</li>
</ul>
</li>
<li>xprintf library setup to provide printf functionality</li>
<li>Initialization of fatfs if FatFs middleware is selected</li>
<li>Initialization of FreeRTOS tasks if defined</li>
<li>Go to <em>main</em> function</li>
</ul>
<h1><a class="anchor" id="sect_board_resource_unified_definitions"></a>
Board Resource Unified Definition</h1>
<p>The board resource definitions defined in <a class="el" href="board_8h.html" title="common board header file ">board.h</a> (the hardware header of each board is included by <a class="el" href="board_8h.html" title="common board header file ">board.h</a>) are described in the table below:</p>
<table class="doxtable">
<tr>
<th align="center">Resource Definitions </th><th align="center">Definition Implication  </th></tr>
<tr>
<td align="center">BOARD_CONSOLE_UART_ID </td><td align="center">Console UART ID </td></tr>
<tr>
<td align="center">BOARD_ADC_IIC_ID </td><td align="center">AD converter IIC interface ID </td></tr>
<tr>
<td align="center">BOARD_TEMP_SENSOR_IIC_ID </td><td align="center">Temperature sensor IIC interface ID </td></tr>
<tr>
<td align="center">BOARD_TEMP_IIC_SLVADDR </td><td align="center">Temperature sensor IIC slave address </td></tr>
<tr>
<td align="center">BOARD_SDCARD_SPI_ID </td><td align="center">SD card SPI interface ID </td></tr>
<tr>
<td align="center">BOARD_WIFI_SPI_ID </td><td align="center">WiFi SPI interface ID </td></tr>
<tr>
<td align="center">BOARD_SFLASH_SPI_ID </td><td align="center">SPI flash SPI interface ID </td></tr>
<tr>
<td align="center">BOARD_SDCARD_SPI_LINE </td><td align="center">SD card SPI interface CS line </td></tr>
<tr>
<td align="center">BOARD_WIFI_SPI_LINE </td><td align="center">WiFI SPI interface CS line </td></tr>
<tr>
<td align="center">BOARD_SFLASH_SPI_LINE </td><td align="center">SPI flash SPI interface CS line </td></tr>
<tr>
<td align="center">BOARD_SYS_TIMER_ID </td><td align="center">System 1 ms interrupt timer ID </td></tr>
<tr>
<td align="center">BOARD_SYS_TIMER_INTNO </td><td align="center">System 1 ms timer interrupt vector no </td></tr>
<tr>
<td align="center">BOARD_SYS_TIMER_HZ </td><td align="center">System timer count frequency (1KHz as default) </td></tr>
<tr>
<td align="center">BOARD_SPI_FREQ </td><td align="center">Board SPI interface common frequency </td></tr>
<tr>
<td align="center">BOARD_SYS_TIMER_MS_HZ </td><td align="center">Board timer count frequency </td></tr>
<tr>
<td align="center">BOARD_SYS_TIMER_MS_CONV </td><td align="center">Converter of board timer count frequency to system timer count frequency </td></tr>
<tr>
<td align="center">BOARD_OS_TIMER_ID </td><td align="center">OS kernel timer ID </td></tr>
<tr>
<td align="center">BOARD_OS_TIMER_INTNO </td><td align="center">OS kernel timer interrupt no </td></tr>
<tr>
<td align="center">BOARD_CPU_CLOCK </td><td align="center">CPU clock of the board </td></tr>
<tr>
<td align="center">BOARD_DEV_CLOCK </td><td align="center">Device clock of the board </td></tr>
<tr>
<td align="center">BOARD_LED_MASK </td><td align="center">LED Mask, if 8 LED, mask is 0xff </td></tr>
<tr>
<td align="center">BOARD_LED_CNT </td><td align="center">LED count </td></tr>
<tr>
<td align="center">BOARD_BTN_MASK </td><td align="center">Button mask </td></tr>
<tr>
<td align="center">BOARD_BTN_CNT </td><td align="center">Button count </td></tr>
<tr>
<td align="center">BOARD_SWT_MASK </td><td align="center">Switch mask </td></tr>
<tr>
<td align="center">BOARD_SWT_CNT </td><td align="center">Switch count </td></tr>
<tr>
<td align="center">BOARD_ONBOARD_NTSHELL_ID </td><td align="center">Default NtShell ID </td></tr>
<tr>
<td align="center">OSP_DELAY_OS_COMPAT_ENABLE </td><td align="center">the delay function is OS compact </td></tr>
<tr>
<td align="center">OSP_DELAY_OS_COMPAT_DISABLE </td><td align="center">the delay function isn't OS compact </td></tr>
<tr>
<td align="center">WF_IPADDR_1 </td><td align="center">WiFi device static IP address 1 </td></tr>
<tr>
<td align="center">WF_IPADDR_2 </td><td align="center">WiFi device static IP address 2 </td></tr>
<tr>
<td align="center">WF_IPADDR_3 </td><td align="center">WiFi device static IP address 3 </td></tr>
<tr>
<td align="center">WF_IPADDR_4 </td><td align="center">WiFi device static IP address 4 </td></tr>
<tr>
<td align="center">WF_NETMASK_1 </td><td align="center">WiFi device static netmask 1 </td></tr>
<tr>
<td align="center">WF_NETMASK_2 </td><td align="center">WiFi device static netmask 2 </td></tr>
<tr>
<td align="center">WF_NETMASK_3 </td><td align="center">WiFi device static netmask 3 </td></tr>
<tr>
<td align="center">WF_NETMASK_4 </td><td align="center">WiFi device static netmask 4 </td></tr>
<tr>
<td align="center">WF_GATEWAY_1 </td><td align="center">WiFi device static gateway 1 </td></tr>
<tr>
<td align="center">WF_GATEWAY_2 </td><td align="center">WiFi device static gateway 2 </td></tr>
<tr>
<td align="center">WF_GATEWAY_3 </td><td align="center">WiFi device static gateway 3 </td></tr>
<tr>
<td align="center">WF_GATEWAY_4 </td><td align="center">WiFi device static gateway 4 </td></tr>
<tr>
<td align="center">WF_HOTSPOT_IS_OPEN </td><td align="center">Specify whether WiFi hot spot is open or not </td></tr>
<tr>
<td align="center">WF_IPADDR_DHCP </td><td align="center">Use DHCP to get ip or not </td></tr>
<tr>
<td align="center">WF_HOTSPOT_NAME </td><td align="center">WiFi hot spot name </td></tr>
<tr>
<td align="center">WF_HOTSPOT_PASSWD </td><td align="center">WiFi hot spot password when not open </td></tr>
<tr>
<td align="center">WF_ENABLE_MANUAL_SET_MAC </td><td align="center">Enable to set MAC manually or not </td></tr>
<tr>
<td align="center">WF_MAC_ADDR0 </td><td align="center">WiFi MAC address 0 (manual set) </td></tr>
<tr>
<td align="center">WF_MAC_ADDR1 </td><td align="center">WiFi MAC address 1 (manual set) </td></tr>
<tr>
<td align="center">WF_MAC_ADDR2 </td><td align="center">WiFi MAC address 2 (manual set) </td></tr>
<tr>
<td align="center">WF_MAC_ADDR3 </td><td align="center">WiFi MAC address 3 (manual set) </td></tr>
<tr>
<td align="center">WF_MAC_ADDR4 </td><td align="center">WiFi MAC address 4 (manual set) </td></tr>
<tr>
<td align="center">WF_MAC_ADDR5 </td><td align="center">WiFi MAC address 5 (manual set) </td></tr>
<tr>
<td align="center">BOARD_PMWIFI_0_ID </td><td align="center">Pmod WiFi 0 ID </td></tr>
<tr>
<td align="center">BOARD_PMWIFI_ID_MAX </td><td align="center">Max Pmod WiFi ID </td></tr>
<tr>
<td align="center">OSP_GET_CUR_SYSHZ </td><td align="center">Macro to get current syshz </td></tr>
<tr>
<td align="center">OSP_GET_CUR_MS </td><td align="center">Macro to get current ms count </td></tr>
<tr>
<td align="center">OSP_GET_CUR_US </td><td align="center">Macro to get current us count </td></tr>
<tr>
<td align="center">OSP_GET_CUR_HWTICKS </td><td align="center">Macro to get current hardware ticks count </td></tr>
<tr>
<td align="center">board_init </td><td align="center">Function for common board initialization </td></tr>
<tr>
<td align="center">board_timer_update </td><td align="center">Called in period interrupt when using OS timer interrupt and not using default timer interrupt </td></tr>
<tr>
<td align="center">board_delay_ms </td><td align="center">ms delay for OS support </td></tr>
</table>
<h1><a class="anchor" id="sect_board_supported_boards_in_embARC"></a>
Supported Boards in embARC</h1>
<p>The BSP Layer currently supports the following boards:</p>
<ul>
<li><b><a class="el" href="page_board_emsk.html">EM Starter Kit</a></b> <br/>
 EM Starter Kit board support can be found under board/emsk, detailed in <b><a class="el" href="group___b_o_a_r_d___e_m_s_k.html">EM Starter Kit (EMSK)</a></b>. It includes the following sub-folders:<ol type="1">
<li><b><a class="el" href="group___b_o_a_r_d___e_m_s_k___c_o_m_m_o_n.html">common</a></b> <br/>
 EMSK board initialization functions and 1 ms interrupt timer function</li>
<li><b><a class="el" href="group___b_o_a_r_d___e_m_s_k___d_r_i_v_e_r.html">drivers</a></b> <br/>
 Various peripheral drivers for various examples</li>
<li><b>configs</b> <br/>
 Different versions of emsk, and various core configurations for different version</li>
</ol>
</li>
<li><b><a class="el" href="page_board_nsim.html">Virtual Board based on nSIM</a></b> <br/>
 nSIM virtual board support can be found under board/nsim, detailed in <b><a class="el" href="group___b_o_a_r_d___n_s_i_m.html">nSIM Virtual Board</a></b>. It includes the following sub-folders:<ol type="1">
<li><b><a class="el" href="group___b_o_a_r_d___n_s_i_m___c_o_m_m_o_n.html">common</a></b> <br/>
 nSIM virtual board initialization functions and 1 ms interrupt timer function</li>
<li><b><a class="el" href="group___b_o_a_r_d___n_s_i_m___d_r_i_v_e_r.html">drivers</a></b> <br/>
 Basic hostlink UART driver for message input and output.</li>
<li><b>configs</b> <br/>
 Different versions of nsim, and various core configurations for different version <dl class="section note"><dt>Note</dt><dd>MetaWare license required</dd></dl>
</li>
</ol>
</li>
<li><b><a class="el" href="page_board_axs.html">AXS Board</a></b> <br/>
 AXS board support can be found under board/axs, detailed in <b><a class="el" href="group___b_o_a_r_d___a_x_s.html">ARC AXS Software Development Platform (AXS)</a></b>. It includes the following sub-folders:<ol type="1">
<li><b><a class="el" href="group___b_o_a_r_d___a_x_s___c_o_m_m_o_n.html">common</a></b> <br/>
 AXS board initialization functions and 1 ms interrupt timer function</li>
<li><b><a class="el" href="group___b_o_a_r_d___a_x_s___d_r_i_v_e_r.html">drivers</a></b> <br/>
 Various peripheral drivers for various examples</li>
<li><b>configs</b> <br/>
 Different versions of axs, and various core configurations for different version</li>
</ol>
</li>
<li><b><a class="el" href="page_board_hsdk.html">ARC HS Development Kit</a></b> <br/>
 HSDK board support can be found under board/hsdk, detailed in <b><a class="el" href="group___b_o_a_r_d___h_s_d_k.html">ARC HS Development Kit (HSDK)</a></b>. It includes the following sub-folders:<ol type="1">
<li><b><a class="el" href="group___b_o_a_r_d___h_s_d_k___c_o_m_m_o_n.html">common</a></b> <br/>
 HSDK board initialization functions and 1 ms interrupt timer function</li>
<li><b><a class="el" href="group___b_o_a_r_d___h_s_d_k___d_r_i_v_e_r.html">drivers</a></b> <br/>
 Various peripheral drivers for various examples</li>
<li><b>configs</b> <br/>
 Support for different board versions (if applicable), and support for different core configurations for each board version (if applicable)</li>
</ol>
</li>
</ul>
<h1><a class="anchor" id="sect_board_add_new_board_to_embARC"></a>
Adding New Board to embARC</h1>
<p>Follow the steps below to add a new board:</p>
<ul>
<li>Modify board.mk and <a class="el" href="board_8h.html" title="common board header file ">board.h</a>. Please refer the EMSK related definitions. Copy EMSK definitions and modify them for your board. EMSK serves as a good template for adding a new board.</li>
<li>Create a sub directory under <b>board</b> and name it as &lt;target_board&gt;. Add &lt;target_board&gt;.mk and &lt;target_board&gt;.h. The basic information should be added in &lt;target_board&gt;.mk, such as source directories, including directories, object output directories and make rules.</li>
<li>Add the source files. The build system will automatically compile all the source files (.c, .s) in the directories described in &lt;target_board&gt;.mk and create library named lib&lt;target_board&gt;.a.</li>
<li>Take other board support folder like <b>&lt;embARC&gt;/board/emsk</b> for reference. </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Apr 27 2018 04:59:10 for embARC by
    <a href="http://www.synopsys.com">
    <img class="footer" src="pic/snps_logo.png" alt="snps_logo"/></a>. All Rights Reserved. </li>
  </ul>
</div>
</body>
</html>
